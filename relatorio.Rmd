---
title: "Relatorio"
author: "Fabio Firanzi, Heitor Dias, Julia Fideles, Matheus Soares, Tiago Braga"
date: "2025-11-11"
output:
  pdf_document:
    latex_engine: pdlatex
    keep_tex: true
header-includes: 
 \usepackage[T1]{fontenc} 
 \usepackage[utf8]{inputenc} 
 \usepackage[portuguese]{babel}
 \usepackage{booktabs} 
 \usepackage{float} 
 \usepackage{graphicx}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
#Carregar as bibliotecas necessárias
library(readxl)
library(dplyr)
library(ggplot2)
library(kableExtra)
library(knitr)
```

# Analise da area de conhecimento de Humanas: Heitor

```{r setup-e-carga, message=FALSE, warning=FALSE}
#Carregar o banco de dados

amostra_10p <- read.csv("amostra_10p.csv")

```


# 1.1 Analise da variavel de presença na prova de humanas
Foi feita uma analise da area de conhecimento de Ciências Humanas do Enem, utilizando a varivel: TP_PRESENCA_CH

## 1.1.1 Gráfico de Frequências das presenças no dia da prova
Busca indentificar se o aluno estava presente, ausente ou se foi eliminado da prova de ciências humanas, e, com isso, expressar a porcentagem e os valores absolutos da variável TP_PRESENCA_CH.

```{r analise_variavel_presenca, message=FALSE, warning=FALSE}

library(scales) # Certifique-se de que este pacote está carregado no início do seu Rmd

# Item 2: Gráfico (Gráfico de Barras com PERCENTUAL e CORES)

ggplot(tabela_presenca, aes(x = reorder(Presenca, -Percentual), 
                           y = Percentual, 
                           fill = Presenca)) +
  
  geom_bar(stat = "identity", show.legend = FALSE) +
  
  # Adiciona o rótulo de percentual no topo da barra
  geom_text(
    aes(label = sprintf("%.2f%%", Percentual)), 
    vjust = -0.5,
    size = 3.5
  ) + 

  scale_y_continuous(
    labels = scales::label_number(suffix = " %"),
    
    # Aumenta o teto do gráfico para o rótulo não cortar
    # (max(tabela_presenca$Percentual) * 1.1) é uma forma segura de
    # garantir que o limite é 10% maior que a maior barra.
    limits = c(0, max(tabela_presenca$Percentual) * 1.1)
  ) +
  
  labs(title = "Gráfico 1: Percentual de Presença na Prova de CH",
       x = "Status de Presença",
       y = "Percentual de Alunos (%)") +
  theme_minimal()

```
O Gráfico 1: Percentual de Presença na Prova de CH, trata dos dados da variável 'TP_PRESENCA_CH'. Uma vez que a variável é do tipo qualitativa, a abordagem mais convencional é um gráfico de barras dos percentuais. 

Com base na analise do gráfico "Percentual de Presença na Prova CH" foi possível determinar que no Exame Nacional do Ensino Médio (ENEM), edição de 2024, o número de alunos presentes foi de aproximadamente 2,73 vezes maior que o número de alunos ausentes. Além disso, percebe-se que a quantidade de alunos elimanados na prova de Ciências Humanas foi extremamente pequena - 0,1% - comparado com os percentuais da coluna "Presença" e da coluna "Ausente".

# 1.2 Analise da variavel de Notas na prova de humanas

```{r analise-medidas-estatistica}
# 1. Carregar o arquivo de dados
# (Assumindo que você já o carregou como 'amostra_10p')
dados <- read.csv("amostra_10p.csv") 

# 2. Criar a Tabela Resumo por Região
tabela_resumo_regiao <- amostra_10p %>%
  
  # PASSO 1: FILTRAR
  # Filtra apenas quem estava PRESENTE e tinha nota de CH
  filter(TP_PRESENCA_CH == 1, !is.na(NU_NOTA_CH), NU_NOTA_CH > 0) %>%
  
  # PASSO 2: "ETIQUETAR" (MUTATE)
  # Cria a nova coluna "Regiao" com base no seu critério
  mutate(Regiao = case_when(
    SG_UF_PROVA %in% c('AM', 'AC', 'RO', 'RR', 'AP', 'PA', 'TO') ~ "Norte",
    SG_UF_PROVA %in% c('MA', 'PI', 'CE', 'RN', 'PB', 'PE', 'AL', 'SE', 'BA') ~ "Nordeste",
    SG_UF_PROVA %in% c('SP', 'MG', 'RJ', 'ES') ~ "Sudeste",
    SG_UF_PROVA %in% c('GO', 'DF', 'MT', 'MS') ~ "Centro-Oeste",
    SG_UF_PROVA %in% c('PR', 'SC', 'RS') ~ "Sul"
  )) %>%
  
  # PASSO 3: AGRUPAR
  # Agora agrupamos pela nova coluna
  group_by(Regiao) %>%
  
  # PASSO 4: CALCULAR AS ESTATÍSTICAS
  # Resumimos os dados para cada Regiao
  summarise(
    media_notas_ch_rg = mean(NU_NOTA_CH),
    mediana_notas_ch_rg = median(NU_NOTA_CH),
    variancia_notas_ch_rg = var(NU_NOTA_CH),
    desvio_padrao_notas_ch_rg = sd(NU_NOTA_CH),
    minimo_notas_ch_rg = min(NU_NOTA_CH),
    maximo_notas_ch_rg = max(NU_NOTA_CH),
    n_alunos_ch_rg = n()
  ) %>%
  
  # PASSO 5: ORDENAR (Opcional)
  arrange(desc(media_notas_ch_rg))

# 3. Exibir a tabela formatada
tabela_resumo_regiao %>%
  kable(
    caption = "Tabela Resumo: Estatísticas das Notas de CH por Região",
    col.names = c("Região", "Média", "Mediana", "Variância", "Desv. Padrão", "Mínimo", "Máximo", "Nº de Alunos"),
    digits = 2, # Arredonda os números
    format = "html"
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  )
```
```{r}
# PASSO 2: Criar o Gráfico Boxplot
ggplot(dados_para_boxplot, aes(x = reorder(Regiao, NU_NOTA_CH, FUN = median), 
                             y = NU_NOTA_CH,
                             fill = Regiao)) + # <-- 1. COR MODIFICADA AQUI
  
  # Desenha os boxplots
  geom_boxplot(
    show.legend = FALSE, # <-- 2. ADICIONADO PARA REMOVER LEGENDA REDUNDANTE
    outlier.shape = 21, 
    outlier.size = 1.5
    # A cor 'fill = "lightblue"' foi removida daqui
  ) +
  
  # "Deita" o gráfico para facilitar a leitura das regiões
  coord_flip() + 
  
  labs(
    title = "Gráfico: Boxplot das Notas de CH por Região",
    subtitle = "Ordenado pela Mediana",
    x = "Região",
    y = "Nota de Ciências Humanas"
  ) +
  theme_minimal()
```


```{r}
VARIAVEL_EM_ANALISE <- "NU_NOTA_CH"

dados_analise <- amostra_10p %>%
  # Filtra alunos PRESENTES na prova de CH
  filter(TP_PRESENCA_CH == 1) %>%
  # Seleciona apenas a nota de CH e renomeia para "Valor"
  select(Valor = all_of(VARIAVEL_EM_ANALISE)) %>%
  # Remove NAs (notas nulas)
  filter(!is.na(Valor))

```



## 1.2.1 Tabela de Frequências (por Classes)

Para dados quantitativos contínuos, criamos classes (faixas de valores) para a tabela de frequências.

```{r}
# 1. Definir os limites das classes (ex: de 50 em 50 pontos)
limites_classes <- seq(
  from = floor(min(dados_analise$Valor) / 50) * 50, # Arredonda para baixo
  to = ceiling(max(dados_analise$Valor) / 50) * 50, # Arredonda para cima
  by = 50 # Intervalo da classe
)

# 2. Criar a tabela de frequências
tabela_freq <- dados_analise %>%
  mutate(Classe = cut(
    Valor,
    breaks = limites_classes,
    right = FALSE # Intervalo [fechado, aberto)
  )) %>%
  count(Classe, name = "Frequencia") %>%
  filter(!is.na(Classe)) %>% # Remove NAs que podem surgir do 'cut'
  mutate(
    Percentual = (Frequencia / sum(Frequencia)) * 100,
    Acumulada = cumsum(Frequencia),
    Percentual_Acumulado = cumsum(Percentual)
  )

# 3. Exibir a tabela formatada
tabela_freq %>%
  kable(
    caption = "Tabela 1: Tabela de Frequências por Classe (Nota de CH)",
    col.names = c("Classe", "Freq. (N)", "%", "Freq. Acum.", "% Acum."),
    digits = 2,
    format = "html"
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), 
                full_width = FALSE) %>%
  # Destaca a Classe Modal (maior frequência)
  row_spec(which.max(tabela_freq$Frequencia), 
           bold = TRUE, 
           background = "#DFF0D8")


```

Interpretação da Tabela 1: A faixa de nota com maior frequência (a Classe Modal) é [500, 550), contendo 21.05% dos alunos.

## 1.2.2 Medidas Descritivas

Calculamos as principais medidas de tendência central, dispersão e posição.





# 1.3 Correlação e Regressão Linear Simples

```{r}
# 2. Filtrar os dados para a regressão
# É MUITO IMPORTANTE filtrar os dados corretamente:
# - Aluno deve estar PRESENTE em AMBAS as provas (CH e LC)
# - Aluno deve ter nota válida (não-NA) em AMBAS
# - Aluno deve ter nota > 0 em AMBAS (para remover notas zeradas)

dados_regressao <- amostra_10p %>%
  filter(
    TP_PRESENCA_CH == 1,
    TP_PRESENCA_LC == 1,
    !is.na(NU_NOTA_CH),
    !is.na(NU_NOTA_LC),
    NU_NOTA_CH > 0,
    NU_NOTA_LC > 0
  ) %>%
  # Seleciona apenas as colunas que vamos usar
  select(NU_NOTA_CH, NU_NOTA_LC)

# Mostra o número de observações válidas para esta análise
paste("Total de observações válidas para a regressão:", nrow(dados_regressao))

# Calcula a correlação
cor_coef <- cor(dados_regressao$NU_NOTA_LC, dados_regressao$NU_NOTA_CH)

# Exibe o resultado
cat(paste0("O Coeficiente de Correlação (r) entre LC e CH é: ", round(cor_coef, 4)))

ggplot(dados_regressao, aes(x = NU_NOTA_LC, y = NU_NOTA_CH)) +
  # 1. Nuvem de pontos
  geom_point(alpha = 0.5, color = "blue") + # 'alpha' ajuda a ver a densidade
  
  # 2. Reta de Regressão (calculada automaticamente pelo ggplot)
  geom_smooth(method = "lm", color = "red", linewidth = 1.5, se = TRUE) +
  
  # Títulos e formatação
  labs(
    title = "Gráfico de Regressão: Nota de Humanas vs. Nota de Linguagens",
    x = "Nota de Linguagens e Códigos (LC)",
    y = "Nota de Ciências Humanas (CH)"
  ) +
  theme_minimal()


```

