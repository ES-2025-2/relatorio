---
title: "Relatório"
author: "Fabio Firanzi, Heitor Dias, Julia Fideles, Matheus Soares, Tiago Braga"
date: "2025-11-11"
output:
  pdf_document:
    latex_engine: pdflatex
    keep_tex: true
    includes:
      in_header: header.tex
classoption: twocolumn
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo     = FALSE,
  message  = FALSE,
  warning  = FALSE,
  fig.pos  = "H",
  fig.path = "relatorio-figs/",
  fig.crop = FALSE,   # evita pdfcrop/ghostscript
  dev      = "pdf"    # usa o dispositivo PDF base (independe de X11/Cairo)
)

# Limpeza opcional da pasta de figuras antes de renderizar
try(
  unlink(
    list.files("relatorio-figs",
               pattern = "^(reg|grafico|hist).*\\.(pdf|png)$",
               full.names = TRUE),
    force = TRUE
  ),
  silent = TRUE
)

```

```{r setup-e-carga, message=FALSE, warning=FALSE}
library(ggplot2)
library(kableExtra)
library(dplyr)

amostra_10p <- read.csv("amostra_10p.csv", fileEncoding = "latin1")

amostra_10p$TP_PRESENCA_MT <- factor(
  amostra_10p$TP_PRESENCA_MT,
  levels = c(0, 1, 2),
  labels = c("Ausente", "Presente", "Eliminado")
)

amostra_10p$CO_PROVA_MT <- factor(
  amostra_10p$CO_PROVA_MT,
  levels = c(1407, 1408, 1409, 1410, 1411, 1412, 1414, 1415, 1416, 1363, 1364, 1365, 1366, 1367, 1368, 1370),
  labels = c("Azul", "Amarela", "Verde", "Cinza", "Verde - Ampliada", "Verde - Superampliada", "Laranja - Adaptada Ledor", "Roxa - Videoprova - Libras", "Roxa - Videoprova - Libras - Ampliada", "Azul (Reaplicação)", "Amarela (Reaplicação)", "Verde (Reaplicação)", "Cinza (Reaplicação)", "Verde - Ampliada (Reaplicação)", "Verde - Superampliada (Reaplicação)", "Laranja - Adaptada Ledor (Reaplicação)")
)
```
**Tabela 1:** Frequência - Presença na Prova de Matemática
```{r tabela-presenca, results='asis'}
freq_abs_presenca <- table(amostra_10p$TP_PRESENCA_MT)
freq_rel_presenca <- prop.table(freq_abs_presenca)

tabela <- data.frame(
  `Presença na prova` = names(freq_abs_presenca),
  Percentual = paste0(round(100 * as.vector(freq_rel_presenca), 2), "%"),
  Frequência = as.vector(freq_abs_presenca),
  check.names = FALSE
)

tab <- knitr::kable(
  tabela,
  format    = "latex",
  booktabs  = TRUE,
  longtable = FALSE  # garante que seja tabular simples
)

cat(tab)  # solta o LaTeX direto

```
**Gráfico 1:** Presença na Prova
```{r grafico-presenca, out.width="\\linewidth"}
df_presenca <- as.data.frame(table(amostra_10p$TP_PRESENCA_MT))
colnames(df_presenca) <- c("Situacao", "Frequencia")

# Calcular percentuais
df_presenca$Percentual <- df_presenca$Frequencia / sum(df_presenca$Frequencia) * 100

ggplot(df_presenca, aes(x = Situacao, y = Percentual, fill = Situacao)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  geom_text(aes(label = paste0(round(Percentual, 2), "%")), vjust = -0.5) +
  labs(
    x = "Situação",
    y = "Percentual (%)"
  ) +
  scale_fill_manual(values = c(
    "Ausente" = "tomato",
    "Presente" = "lightgreen",
    "Eliminado" = "skyblue"
  )) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank())
```

## 1. Análise da Presença na Prova de Matemática

A Tabela 1 mostra que 30,56% dos inscritos não compareceram, enquanto 69,38% estiveram presentes e apenas 0,06% foram eliminados. Essa discrepância revela dois pontos centrais:

### 1.1 Comparação entre presença e ausência

A quantidade de presentes é mais do que o dobro da de ausentes, indicando que, embora a taxa de ausência seja significativa, a maior parte dos estudantes permanece engajada e comparece à prova.

### 1.2 Ausências ainda são um desafio estrutural

Com mais de 132 mil ausentes, observa-se uma dificuldade que pode estar associada a:

* Logística de deslocamento

* Realização da prova em dia único

* Desmotivação ou insegurança com o exame

O gráfico 1 reforça visualmente essa diferença, tornando evidente o contraste entre o volume de presentes e ausentes.

---

```{r calcula-dados-gerais, include=FALSE}
freq_abs_tipo_de_prova <- table(amostra_10p$CO_PROVA_MT)
freq_rel_tipo_de_prova <- prop.table(freq_abs_tipo_de_prova)
tabela_geral <- data.frame(
  `Tipo de prova` = names(freq_abs_tipo_de_prova),
  Frequência = as.vector(freq_abs_tipo_de_prova),
  Proporção = round(as.vector(freq_rel_tipo_de_prova), 4),
  Percentual = paste0(round(100 * as.vector(freq_rel_tipo_de_prova), 2), "%"),
  check.names = FALSE
)
```
**Tabela 2:** Provas Padrão vs. Acessibilidade
```{r tabela-acessibilidade, results='asis'}
tabela_resumida <- tabela_geral %>%
  mutate(Categoria = ifelse(
    grepl("Ampliada|Superampliada|Adaptada|Videoprova", `Tipo de prova`),
    "Prova com acessibilidade", "Prova padrão"
  )) %>%
  group_by(Categoria) %>%
  summarise(Frequência = sum(Frequência), .groups = 'drop') %>%
  mutate(
    Proporção = Frequência / sum(Frequência),
    Percentual = paste0(round(Proporção * 100, 2), "%"),
  )

tabela_para_exibir <- tabela_resumida %>%
  select(Categoria, Percentual, Frequência)

tab2 <- knitr::kable(
  tabela_para_exibir,
  format    = "latex",
  booktabs  = TRUE,
  longtable = FALSE
)

cat(tab2)
```

**Gráfico 2:** Proporção de Provas com Acessibilidade
```{r grafico-acessibilidade, out.width="\\linewidth", fig.asp=0.8}

# Criar categorias de acessibilidade conforme o dicionário
tabela_acessiveis <- tabela_geral %>%
  mutate(
    Categoria = case_when(
      grepl("Ampliada", `Tipo de prova`) & !grepl("Super", `Tipo de prova`) & !grepl("Libras", `Tipo de prova`) ~ "Ampliada",
      grepl("Superampliada", `Tipo de prova`) ~ "Superampliada",
      grepl("Adaptada Ledor", `Tipo de prova`) ~ "Adaptada Ledor",
      grepl("Videoprova - Libras - Ampliada", `Tipo de prova`) ~ "Libras - Ampliada",
      grepl("Videoprova - Libras", `Tipo de prova`) ~ "Videoprova - Libras",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(Categoria)) %>%   # manter só provas com acessibilidade
  group_by(Categoria) %>%
  summarise(
    Frequência = sum(Frequência),
    .groups = "drop"
  ) %>%
  mutate(
    Proporcao_relativa = Frequência / sum(Frequência),
    Percentual_relativo = Proporcao_relativa * 100
  )

# Gráfico de coluna
ggplot(tabela_acessiveis, aes(x = Categoria, y = Percentual_relativo, fill = Categoria)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = paste0(round(Percentual_relativo, 2), "%")), 
            vjust = -0.5, size = 3) +
  labs(
    x = "Tipo de prova com acessibilidade",
    y = "Percentual dentro das provas acessíveis (%)"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 20, hjust = 1),
    panel.grid.major.x = element_blank()
  )

```

## 2. Provas Padrão vs. Provas com Acessibilidade

A Tabela 2 mostra que 99,78% dos candidatos fizeram prova padrão, enquanto apenas 0,22% demandaram acessibilidade (cerca de 676 estudantes.)

### 2.1 Proporção extremamente baixa de necessidades especiais

Esse valor sugere duas possíveis interpretações:

* O número real de estudantes com necessidades específicas pode ser baixo.

* Ou há subregistro de solicitação de acessibilidade, o que é comum em exames de grande porte, seja por desconhecimento ou receio de burocracias.

### 2.2 Distribuição interna entre tipos de acessibilidade

O gráfico da página 1 revela que, dentro das provas acessíveis:

* Ampliada é a modalidade mais comum (quase metade dos casos).

* Adaptada Ledor, Superampliada e Videoprova Libras aparecem em segundo plano.

* Libras – Ampliada não ocorreu, indicando pouca demanda ou ausência de candidatos elegíveis.

Essa distribuição mostra que deficiência visual é o principal motivo para solicitação de acessibilidade, seguido de necessidades pedagógicas específicas.

---

**Tabela 3:** Frequência Intervalar da Nota de Matemática
```{r tabela-nota-mt, results='asis'}
# Intervalos de 0 a 1000, de 100 em 100
breaks_nota  <- seq(0, 1000, by = 100)
labels_nota  <- paste(head(breaks_nota, -1), "–", tail(breaks_nota, -1))

faixa_nota <- cut(
  amostra_10p$NU_NOTA_MT,
  breaks = breaks_nota,
  include.lowest = TRUE,
  right = FALSE,
  labels = labels_nota
)

freq_abs <- table(faixa_nota)
freq_rel <- prop.table(freq_abs)

tabela_nota <- data.frame(
  `Intervalo de nota` = names(freq_abs),
  Percentual = paste0(round(100 * as.vector(freq_rel), 2), "%"),
  check.names = FALSE
)

tab3 <- knitr::kable(
  tabela_nota,
  format    = "latex",
  booktabs  = TRUE,
  longtable = FALSE
)

cat(tab3)
```

## 3. Distribuição das Notas de Matemática

A Tabela 3 divide as notas em intervalos de 100 pontos, permitindo observar o comportamento geral do desempenho dos estudantes.

### 3.1 Concentração forte em torno do meio da distribuição

Os intervalos com maiores proporções são:

* 400–500: 40,17%

* 500–600: 22,48%

Somando esses dois grupos, mais de 62% dos participantes estão entre 400 e 600 pontos, indicando que:

* A maior parte dos estudantes teve desempenho mediano, nem muito baixo, nem muito alto.

* A dificuldade da prova parece adequadamente calibrada para centralizar alunos em torno da média.

## 3.2 Baixa incidência de notas extremas

Notas muito baixas (<300) e muito altas (>800) representam percentual muito pequeno:

* <100 pontos: 0,03%

* 800–900: 1,52%

* 900–1000: 0,18%

Esses valores sugerem que a prova discrimina bem alunos com domínio intermediário, mas raramente produz desempenhos extremos.

---

**Gráfico 3:** Histograma das Notas de Matemática com Curva Normal 
```{r hist-nota-mt-normal, out.width="\\linewidth", fig.asp=0.8}

# Média e desvio padrão
media_mt <- mean(amostra_10p$NU_NOTA_MT, na.rm = TRUE)
sd_mt    <- sd(amostra_10p$NU_NOTA_MT, na.rm = TRUE)

ggplot(amostra_10p, aes(x = NU_NOTA_MT)) +
  
  # Histograma em frequência relativa (%)
  geom_histogram(
    aes(y = after_stat(density * 100 )),  # densidade convertida para %
    binwidth = 100,
    boundary = 0,
    fill = "steelblue",
    color = "white",
    alpha = 0.7
  ) +

  # Curva normal ajustada, também em %
  stat_function(
    fun = function(x) dnorm(x, mean = media_mt, sd = sd_mt) * 100,
    color = "red",
    linewidth = 1.2
  ) +

  labs(
    x = "Nota de Matemática",
    y = "Frequência relativa"
  ) +
  theme_minimal() +
  theme(
    panel.grid.major.x = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold")
  )
```

## 4. Ajuste à Curva Normal da Distribuição

O histograma com a curva normal ajustada mostra que:

### 4.1 A distribuição é aproximadamente normal

A forma do gráfico indica:

* Picos de densidade próximos ao centro

* Decaimento simétrico nos extremos

* Ausência de longas caudas que caracterizariam assimetria acentuada

Isso sugere que:

* O exame conseguiu distribuir os alunos segundo um padrão próximo ao esperado estatisticamente.

* Há equilíbrio entre questões fáceis, intermediárias e difíceis.

4.2 Diferença entre curva teórica e real

Pequenas diferenças entre a curva real e a curva normal ajustada indicam que:

* Alguns níveis de nota são mais frequentes que o previsto pela normal (natural em testes educacionais).
